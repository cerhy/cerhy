<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link id="hello" type="text/css" rel="stylesheet" href="/${res}/css/custom.css" />
<link href="${resSys}/front.css" rel="stylesheet" type="text/css"/>
<script src="${resSys}/jquery.js" type="text/javascript"></script>
<script src="${resSys}/front.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="/${res}/css/hyindex.css" />
<link rel="stylesheet" type="text/css" href="/${res}/css/custom.css" />
<script type="text/javascript">
$(function(){
$('.user-menu-links li').click(function(){
    $(this).toggleClass('on');
});
});
</script>
<link  type="text/css" rel="stylesheet" href="/${res}/css/SimpleTree.css" />
<script src="/${res}/js/SimpleTree.js"></script>
<style>
.s1{
    margin: 25px 0 60px 0;}
.st_tree ul .change a:hover{color:red;}
.st_tree ul li a:hover{color:blue;}
.st_tree ul .change :hover{background-color:#e7e7e7 }
::-webkit-scrollbar{width:0px}
.clear{clear:both}
#tab{position:relative;}
#tab .tabList ul li{
	float:left;
	background:#fefefe;
	background:-moz-linear-gradient(top, #fefefe, #ededed);	
	background:-o-linear-gradient(left top,left bottom, from(#fefefe), to(#ededed));
	background:-webkit-gradient(linear,left top,left bottom, from(#fefefe), to(#ededed));
	border:1px solid #ccc;
	padding:5px 0;
	width:100px;
	text-align:center;
	margin-left:-1px;
	position:relative;
	cursor:pointer;
}
#tab .tabList li.cur{
	border-bottom:none;
	background:#fff;
}
</style>
<script type="text/javascript">
$(function(){
	$(".st_tree").SimpleTree({
		click:function(a){
			if(!$(a).attr("hasChild"))
				alert($(a).attr("ref"));
		}
	});
});
</script>
<script type="text/javascript">
$(document).ready(function(){
    $("#checkb").click(function(){
        enter();
	});
});
function enter(){
	if($('input[name="checkb"]').prop("checked")){
		$.ajax({
	        url: "${base}/blog/uniqueNum.jspx",
	        type: "POST",
	        dataType:"json",
	        data: "",
	        success: function (data) {
		 		$("#sh").show();
				$("#uniqueCode").val(data.status)
	        }
	    });
	}else{
		$("#sh").hide();
		$("#uniqueCode").val("")
	}	
}
</script>
<script type="text/javascript">
window.onload=function(event){
    var button=document.getElementById("btn");
    button.onclick=function(event){
        document.getElementById("uniqueCode").select();
        document.execCommand("copy",false,null);
        $("#info").html("复制成功...");
        $("#info").animate({opacity: "hide"},5000);
    };
};
</script>
[#include "head.html"/]
<div class="blogBody">
<div class="blog-con">
  <div class="blogHead">
    <div class="title1"><a href="${base}/blog/index.jspx"><span id="title1">[#if user.blogTitle??]${user.blogTitle}[#else]标题[/#if]</span></a></div>
	  <div style="font-size:15px;margin:5px auto 15px;">[#if user.blogTitle2??]${user.blogTitle2}[#else]副标题[/#if]</div>
  </div>
  <div>
      	<div class="tj">
     	 	文章数:${articleCount}&nbsp;&nbsp;评论:${commentCount}&nbsp;&nbsp;访问:${user.blogVisitNum!'0'}&nbsp;&nbsp;最后登录:${user.lastLoginTime?string('yyyy-MM-dd HH:mm:ss')}
      	</div>
      </div>
      <div class="mb20 clearfix">
           [#include "blog_left.html"/]

			<div class="wrap-right " >
				<div class="personCenter-userInfo blog_right" >
				
        <div class="tggl" >
        <form id="newColumn" action="${base}/blog/newColumn.jspx"  method="post">
        <div >
	        <span style="font-size:16px;">栏目名称:</span>
	        <input type="text" maxlength="15" name="columnInput" required="required" style="margin:10px;width: 180px;height: 30px;" rerequired oninvalid="setCustomValidity('请输入栏目名称');" oninput="setCustomValidity('');"/><span style="color:#f00; margin-left:10px;">*</span>
	        <input type="checkbox" id="checkb" name="checkb" onclick="checkb()" />
        	<span>是否将该栏目作为群组。</span>
        </div>
        <div style="display: none;" id="sh">
        	<span style="font-size:16px;">群组唯一标识码:</span>
        	<input type="text" style="margin:10px;width: 180px;height: 30px;" id="uniqueCode" name="uniqueCode" readonly="readonly"/>
        	<span><a onmouseover="this.style.cssText='color:red;cursor: pointer;'" onmouseout="this.style.cssText='color:black'" href="javascript:;" id="btn" >复制</a></span>
        	<span id="info" style="color: red;font-size: 2px;"></span>
        </div>
        <div>
         <span style="font-size:16px;">栏目序号:</span>
         <input type="text" name="columnOrder" style="margin:10px;width: 180px;height: 30px;" placeholder="默认 0"/>
         </div>
         <div class="s1">
             <input type="submit" value="新建" class="sub1" />
         </div>
        </form>
          
		<div id="tab">
		  <div class="tabList">
			<ul>
				<li class="cur">栏目</li>
				<li>已加入的群组</li>
			</ul>
		  </div>
		</div>
		<br />
		<br />
		<form id="tableForm0" action="" method="post">
          <table cellpadding="0" cellspacing="0">
            <tbody>
          [#if columnsList?size gt 0]
              <tr>
               <td class="tggl-top" style="font-size:14px;min-width: 80px;">栏目序号</td>
               <td class="tggl-top" style="font-size:14px;min-width: 200px;">栏目名称</td>
               <td class="tggl-top" style="font-size:14px;min-width: 100px;">群组唯一标识码</td>
               <td class="tggl-top" style="font-size:14px;min-width: 100px;">操作</td>
              </tr>
              [#list columnsList as c]
              <tr>
              <td>${c.orderId}</td>
                <td>${c.columnName}</td>
                <td>${c.uniqueCode!""}</td>
                <td><a href="${base}/blog/update_tz.jspx?id=${c.columnId}&name=${c.columnName}&orderId=${c.orderId}&uniqueCode=${c.uniqueCode!''}">修改<a> | [#if c.uniqueCode??][#else]<a href="${base}/blog/deteleColumn.jspx?id=${c.columnId}">删除<a>[/#if]</td>
              </tr>
              [/#list]
            [#else]
             <tr>
               <td class="tggl-top" style="font-size:14px;" colspan="4">暂无栏目/组..</td>
              </tr>
            [/#if]
            </tbody>
          </table>
          </form>
		<form id="tableForm1" action="" method="post" style="display: none;">
          <table cellpadding="0" cellspacing="0">
            <tbody>
              [#if joinGroupList??&&joinGroupList?size gt 0]
              <tr>
               <td class="tggl-top" style="font-size:14px;min-width: 80px;" colspan="4">已加入的群组</td>
              </tr>
              <tr>
               <td class="tggl-top" style="font-size:14px;min-width: 200px;">群组名称</td>
               <td class="tggl-top" style="font-size:14px;min-width: 100px;">加入时间</td>
               <td class="tggl-top" style="font-size:14px;min-width: 100px;">群组唯一标识码</td>
               <td class="tggl-top" style="font-size:14px;min-width: 100px;">操作</td>
              </tr>
               [#list joinGroupList as j]
              <tr id="signOut${j.id}">
                <td>[@text_cut s=j.columnsId.columnName len=6 append='...'/]</td>
                <td>${j.joinTime}</td>
                <td>${j.joinCode}</td>
                <td onclick="signOut(${j.id})" style="cursor: pointer;" id="signOut" class="signOut">退出群组</td>
              </tr>
              [/#list]
              [#else]
              <tr>
               <td class="tggl-top" style="font-size:14px;" colspan="4">暂无加入的群组...</td>
              </tr>
              [/#if]
            </tbody>
          </table>
          </form>
        </div>
      </div>
			</div>
		</div>
</div>
</div>
[#include "model.html"/]
[#include "../include/footer.html"/]
</body>
</html>
<script type="text/javascript">
function signOut(obj){
	var msg = "您确定要退出该群组吗？"; 
	 if (confirm(msg)==true){ 
		 $.ajax({
		        url: "${base}/blog/signOutGroup.jspx?groupId="+obj,
		        type: "POST",
		        dataType:"json",
		        data: "",
		        success: function (data) {
		        	if(data.status>0){
						 $("#signOut"+obj).fadeOut();
						 location.reload(); 
		        	}else{
		        		alert("群组退出失败!");
		        	}
		        }
		    });
	     return true; 
	 }else{ 
	     return false; 
	 } 
}
</script>
<script>
window.onload = function() {
    var oDiv = document.getElementById("tab");
    var oLi = oDiv.getElementsByTagName("div")[0].getElementsByTagName("li");
    var timer = null;
    for (var i = 0; i < oLi.length; i++) {
        oLi[i].index = i;
        oLi[i].onmouseover = function() {
            show(this.index);
        }
    }
    function show(a) {
        index = a;
        var alpha = 0;
        for (var j = 0; j < oLi.length; j++) {
            oLi[j].className = "";
            $("#tableForm"+j).hide();
        }
        oLi[index].className = "cur";
        $("#tableForm"+index).show();
        clearInterval(timer);
    }
}
</script>