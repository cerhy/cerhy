<style>
::-webkit-scrollbar{width:0px}
.clear{clear:both}
</style>
<script type="text/javascript">
$(function(){
$('.user-menu-links li').click(function(){
    $(this).toggleClass('on');
});
});
</script>
<div id="contextMenus"></div>
            <div class="personCenter-userInfo blog_right" >
	          <form id="jvForm" action="add_link.jspx" method="post" style="height: 400px;">
	         	<textarea id="hyperlink" name="hyperlink" rows="18" cols="100">${linkUrls }</textarea>
	         	<br />
	          	<span class="fl">
					<p>每行可以输入一个链接，标题和网址之间用“=”分隔开，不可以将网址单独作为一行，最多可设置350个。</p>
					<p>链接可以分组，不包含“=”号的行就是分组标题。</p>
					<p>例如：</p>
					<p>海南教育研究新浪微博=http://t.sina.com.cn/hainanvae</p>
					<p>教育行政部门</p>
					<p>中国教育部=http://www.moe.edu.cn</p>
					<p>海南教育厅=http://edu.hainan.gov.cn</p>
					<p>*注:请勿留有空格!避免在分组名(如:教育行=政部门)/备注名(如:海南=教育厅)中填写等号(=)</p>
					<p>添加好友链接结束,无需按回车健换行,以免导致格式不正确提交不成功!</p>
		          	<input style="display: none;" name="nextUrl" value="link_list.jspx" /><br />
		          	 <input type="button" value="提交" class="submit" id="addlink"  onclick="saveUpdateRefresh()">
				</span>
	          </form> 
            </div>
<script type="text/javascript">
function saveUpdateRefresh(){
        var hyperlink=$("#hyperlink").val();
    	var hyperlinks = hyperlink.replace(new RegExp( "\\n", "g" ),"~");
    	var str =hyperlinks.split("~");
		var num=0;
    	for(var i=0;i<str.length;i++){
    		if(str[i].split("=").length>2){
    			alert("请勿填写多余的等号(=)!");
    	        return false;
    		}
    		if(str[i].indexOf("=")==-1&&str[i].indexOf("http")!=-1){
    			alert("请填写正确的链接格式!");
   	            return false;
    		}
			if(str[i].indexOf("=")!=-1){
				num++;
			}
		}
		if(num>350){
			 alert("链接添加超过显示限制个数!");
             return false;
		}
		$.ajax({
    		url:"${base}/blog/add_update_refresh.jspx",
    		type:"POST",
    		dataType:"json",
    		 data : {'hyperlink' : hyperlink.replace(new RegExp( "\\n", "g" ),"\r\n")},
    		success: function (data) {
    			if(data.status==1){
    				alert("链接添加失败");
    				return false;
    			}else{
    				$.ajax({
    			           type: 'GET',
    			           url : '${base}/blog/refreshColumn.jspx',
    			           dataType:"html",
    			           async: true,
    			           success : function(datas){
    			        	   $("#appendHtml").empty();
    			        	   $("#joinGroups").remove();
    			               $("#appendHtml").append(datas);
    			               if(window._bd_share_main){
    			            	   window._bd_share_main.init();
    			            	}
    			  	   		 }
    			 	});
                     return true;
    			}
            }
    	});
    	//var obj = $(this);
    	//obj.parents('form').submit(); //验证码正确提交表单
        //return true;
}

       
</script>